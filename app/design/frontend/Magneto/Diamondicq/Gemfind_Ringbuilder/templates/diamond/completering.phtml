<?php
// Currency Changes
$priceHelper = $this->helper('Magneto\RingBuilder\ViewModel\PriceHelper');
$ringbuilderHelper = $this->helper(Gemfind\Ringbuilder\Helper\Data::class);
$setting = $block->getSelectedRing();
$settingcoockieval = [];
$labsettings = false;
if ($block->getRingCookieData()) {
    $settingcoockieval = $block->getRingCookieData();
    if ($settingcoockieval->Filtermode == 'labsettings') {
        $labsettings = true;
    } else {
        $labsettings = false;
    }
} else {
    $labsettings = false;
}

$diamond = $selectedDiamond = $block->getSelectedDiamond();
$ringSize = 7;
if (isset($setting['selectedData']) && $setting['selectedData']->ringsize) {
    $ringSize = $setting['selectedData']->ringsize;
}

$ringId = '';
if (isset($setting['selectedData']) && $setting['selectedData']->shapes) {

    $ringId = $setting['selectedData']->shapes;
}

$diamondId = '';

if (isset($selectedDiamond['diamondData']) && isset($selectedDiamond['diamondData']['diamondId']) && $selectedDiamond['diamondData']['diamondId']) {

    $diamondId = $selectedDiamond['diamondData']['diamondId'];
}
?>

<?php if ($setting && sizeof($setting['ringData']) > 0) {

    $settingid = $setting['ringData']['settingId'];

    $hasvideo = $type = 0;

    if (isset($setting['ringData']['videoURL']) && $setting['ringData']['videoURL'] != '') {

        $headers = $block->is_404($setting['ringData']['videoURL']);
        if (!$headers) {

            $hasvideo = 1;
            if (strpos($setting['ringData']['videoURL'], '.mp4') !== false) {
                $type = 1;
            } else {
                $type = 2;
            }
        }
    } else {
        $hasvideo = 0;
    }
    ?>
    <?php if (isset($setting['ringData']['mainImageURL'])) {

        $imgurl = $setting['ringData']['mainImageURL'];
    }

    ?>

    <div class="loading-mask gemfind-loading-mask" id="gemfind-loading-mask" style="display: none;">
        <div class="loader gemfind-loader">
            <p><?php echo __('Please wait...') ?></p>
        </div>
    </div>
    <div class="main-ringbuilder-banner">
       <?php echo $block->getLayout()->createBlock(\Magento\Cms\Block\Block::class)->setBlockId('ring-builder-main-banner')->toHtml();?>
   </div>
   <div id="search-rings" class="flow-tabs">
    <div class="tab-section">
            <!-- <ul class="tab-ul">
                <?php if ($labsettings) { ?>
                <li class="tab-li">
                    <div>
                        <a href="<?php echo $block->getUrl('ringbuilder/settings').'type/labsettings'; ?>">
                            <span class="tab-title"><?php echo __('Choose Your'); ?><strong><?php echo __(' Setting'); ?></strong></span>
                            <i class="ring-icon tab-icon"></i>
                        </a>
                    </div>
                </li>
                <?php } else { ?>
                <li class="tab-li">
                    <div>
                        <a href="<?php echo $block->getUrl('ringbuilder/settings'); ?>">
                            <span class="tab-title"><?php echo __('Choose Your'); ?><strong><?php echo __(' Setting'); ?></strong></span>
                            <i class="ring-icon tab-icon"></i>
                        </a>
                    </div>
                </li>
                <?php } ?>
                <li class="tab-li">
                    <div>
                        <a href="javascript:;">
                            <span class="tab-title"><?php echo __('Choose Your'); ?><strong><?php echo __(' Diamond'); ?></strong></span>
                            <i class="diamond-icon tab-icon"></i>
                        </a>
                    </div>
                </li>
                <li class="tab-li active">
                    <div>
                        <a href="javascript:;">
                            <span class="tab-title"><?php echo __('Review'); ?><strong><?php echo __(' Complete Ring'); ?></strong></span>
                            <i class="finalring-icon tab-icon"></i>
                        </a>
                    </div>
                </li>
            </ul> -->
            <ul class="tab-ul">
                <?php if ($labsettings) { ?>
                    <li class="tab-li">
                        <div>
                            <a href="<?php echo $block->getUrl('ringbuilder/settings').'type/labsettings'; ?>">
                                <span class="tab-title">
                                    <p><?php echo __('1'); ?></p><?php echo __('Choose Setting'); ?>
                                </span>
                                <div class="img">
                                    <img src="<?php echo $this->getViewFileUrl('images/setting.png'); ?>" alt="choose-setting">
                                </div>
                            </a>
                        </div>
                    </li>
                <?php } else { ?>
                    <li class="tab-li">
                        <div>
                            <a href="<?php echo $block->getUrl('ringbuilder/settings'); ?>">
                                <span class="tab-title">
                                    <p><?php echo __('1'); ?></p><?php echo __('Choose Setting'); ?>
                                </span>
                                <div class="img">
                                    <img src="<?php echo $this->getViewFileUrl('images/setting.png'); ?>" alt="choose-setting">
                                </div>
                            </a>
                        </div>
                    </li>
                <?php } ?>
                <li class="tab-li">
                    <div>
                        <a href="javascript:;">
                            <span class="tab-title">
                                <p><?php echo __('2'); ?></p><?php echo __('Choose Diamond'); ?>
                            </span>
                            <div class="img">
                             <img src="<?php echo $this->getViewFileUrl('images/choosediamond.png'); ?>" alt="choose-diamond">
                         </div>
                     </a>
                 </div>
             </li>
             <li class="tab-li active">
                <div>
                    <a href="javascript:;">
                        <span class="tab-title">
                            <p><?php echo __('3'); ?></p><?php echo __('Completed Ring'); ?>
                        </span>
                        <div class="img">
                            <img src="<?php echo $this->getViewFileUrl('images/cring.png'); ?>" alt="completed-ring">
                        </div>
                    </a>
                </div>
            </li>
        </ul>
    </div>

    <div class="tab-content">
        <div class="d-container container">
            <div class="d-row">
                <div class="diamonds-preview no-padding">
                    <div class="diamond-info">
                        <div class="diamond-image">
                           <div class="top-icons">
                            <span class="zoom-icon" id="zoom_me">
                               <svg
                               xmlns="http://www.w3.org/2000/svg"
                               xmlns:xlink="http://www.w3.org/1999/xlink"
                               width="22px" height="22px">
                               <path fill-rule="evenodd"  fill="rgb(148, 148, 148)"
                               d="M22.001,20.308 C22.001,20.775 21.835,21.174 21.505,21.505 C21.174,21.835 20.775,22.001 20.308,22.001 C19.832,22.001 19.436,21.833 19.118,21.498 L14.583,16.976 C13.006,18.069 11.247,18.616 9.308,18.616 C8.047,18.616 6.842,18.371 5.691,17.882 C4.541,17.393 3.549,16.732 2.716,15.899 C1.883,15.066 1.222,14.074 0.733,12.924 C0.244,11.773 -0.001,10.568 -0.001,9.308 C-0.001,8.047 0.244,6.842 0.733,5.692 C1.222,4.541 1.883,3.550 2.716,2.717 C3.549,1.884 4.541,1.222 5.691,0.733 C6.842,0.244 8.047,-0.001 9.308,-0.001 C10.568,-0.001 11.774,0.244 12.924,0.733 C14.075,1.222 15.066,1.884 15.899,2.717 C16.732,3.550 17.393,4.541 17.882,5.692 C18.371,6.842 18.616,8.047 18.616,9.308 C18.616,11.247 18.070,13.006 16.977,14.583 L21.511,19.119 C21.838,19.445 22.001,19.841 22.001,20.308 ZM13.493,5.123 C12.333,3.964 10.938,3.384 9.308,3.384 C7.677,3.384 6.282,3.964 5.123,5.123 C3.964,6.282 3.384,7.677 3.384,9.308 C3.384,10.938 3.964,12.333 5.123,13.492 C6.282,14.651 7.677,15.231 9.308,15.231 C10.938,15.231 12.333,14.652 13.493,13.492 C14.652,12.333 15.231,10.938 15.231,9.308 C15.231,7.677 14.652,6.282 13.493,5.123 ZM13.116,10.154 L10.154,10.154 L10.154,13.116 C10.154,13.230 10.112,13.330 10.028,13.413 C9.945,13.497 9.846,13.539 9.731,13.539 L8.885,13.539 C8.770,13.539 8.671,13.497 8.587,13.413 C8.504,13.330 8.462,13.230 8.462,13.116 L8.462,10.154 L5.500,10.154 C5.385,10.154 5.286,10.112 5.202,10.028 C5.119,9.944 5.077,9.845 5.077,9.731 L5.077,8.884 C5.077,8.770 5.119,8.671 5.202,8.587 C5.286,8.503 5.385,8.461 5.500,8.461 L8.462,8.461 L8.462,5.500 C8.462,5.385 8.504,5.286 8.587,5.202 C8.671,5.118 8.770,5.077 8.885,5.077 L9.731,5.077 C9.846,5.077 9.945,5.118 10.028,5.202 C10.112,5.286 10.154,5.385 10.154,5.500 L10.154,8.461 L13.116,8.461 C13.231,8.461 13.330,8.503 13.414,8.587 C13.497,8.671 13.539,8.770 13.539,8.884 L13.539,9.731 C13.539,9.845 13.497,9.944 13.414,10.028 C13.330,10.112 13.231,10.154 13.116,10.154 Z"/>
                           </svg>

                       </span>

                       <?php if ($hasvideo) { ?>

                        <span class="videoicon" onclick="Videorun(event);">
                           <svg
                           xmlns="http://www.w3.org/2000/svg"
                           xmlns:xlink="http://www.w3.org/1999/xlink"
                           width="24px" height="21px">
                           <path fill-rule="evenodd"  fill="rgb(148, 148, 148)"
                           d="M23.224,21.000 C22.545,21.000 18.182,16.957 18.182,16.425 L18.182,11.128 C18.182,10.596 22.448,6.553 23.224,6.553 C24.000,6.553 24.000,7.275 24.000,7.275 L24.000,20.278 C24.000,20.278 23.903,21.000 23.224,21.000 ZM16.291,19.917 L1.164,19.917 C0.521,19.917 -0.000,19.550 -0.000,19.098 L-0.000,8.455 C-0.000,8.003 0.521,7.636 1.164,7.636 L16.291,7.636 C16.934,7.636 17.454,8.003 17.454,8.455 L17.454,19.098 C17.454,19.550 16.934,19.917 16.291,19.917 ZM12.364,7.223 C10.355,7.223 8.727,5.606 8.727,3.612 C8.727,1.617 10.355,-0.000 12.364,-0.000 C14.372,-0.000 16.000,1.617 16.000,3.612 C16.000,5.606 14.372,7.223 12.364,7.223 ZM4.364,7.223 C2.757,7.223 1.454,5.930 1.454,4.334 C1.454,2.738 2.757,1.444 4.364,1.444 C5.970,1.444 7.273,2.738 7.273,4.334 C7.273,5.930 5.970,7.223 4.364,7.223 Z"/>
                       </svg>

                   </span>

               <?php } ?>
           </div>

           <div class="diamondvideo" id="ringvideo" <?php if (!$hasvideo) { ?> style="display: none;" <?php } ?>>

            <?php if ($type == 1) { ?>
                <video playsinline="" autoplay="" loop="" muted="" width="" height="">
                    <source src="<?php echo $setting['ringData']['videoURL']; ?>" type="video/mp4">
                    </video>

                <?php } elseif ($type == 2) { ?>
                    <iframe src="<?php echo $setting['ringData']['videoURL']; ?>" id="iframevideo" scrolling="no"></iframe>

                <?php } else {

                    echo __('No Video');
                } ?>
            </div>
            <div id="ringimg"></div>
            <div class="magentoGallerywidget" id="magentoGallerywidget">

            </div>
            <h2><?php echo __('SKU#') ?><span><?php echo $setting['ringData']['styleNumber'] ?></span></h2>
        </div>

    </div>

    <div class="diamond-content-data">
        <div class="form-field diamonds-info">
            <p class="imagenote">
                <span><?php echo __('NOTE:'); ?></span><?php echo __(' All metal color images may not be available.'); ?>
            </p>
        </div>
    </div>
</div>

<div class="ring-details no-padding ring-request-form">
    <div class="ring-data" id="ring-data">
        <div class="ring-specification-title">
            <div class="mainsec-name">
                <h2><?php echo $setting['ringData']['settingName'] ?></h2>
            </div>
            <h4 class="complete-ring-spec">
                <a href="javascript:;" id="spcfctn" onclick="CallSpecification();">

                    <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"

                    width="20px" height="20px" viewBox="0 0 612 612"
                    style="enable-background:new 0 0 612 612;" xml:space="preserve">
                    <g>
                       <g id="New_x5F_Post">
                           <g>
                               <path d="M545.062,286.875c-15.854,0-28.688,12.852-28.688,28.688v239.062h-459v-459h239.062

                               c15.854,0,28.688-12.852,28.688-28.688S312.292,38.25,296.438,38.25H38.25C17.136,38.25,0,55.367,0,76.5v497.25

                               C0,594.883,17.136,612,38.25,612H535.5c21.114,0,38.25-17.117,38.25-38.25V315.562

                               C573.75,299.727,560.917,286.875,545.062,286.875z M605.325,88.95L523.03,6.655C518.556,2.18,512.684,0,506.812,0

                               s-11.743,2.18-16.218,6.675l-318.47,318.45v114.75h114.75l318.45-318.45c4.494-4.495,6.675-10.366,6.675-16.237

                               C612,99.297,609.819,93.445,605.325,88.95z M267.75,382.5H229.5v-38.25L506.812,66.938l38.25,38.25L267.75,382.5z"/>
                           </g>
                       </g>
                   </g>
               </svg>
               <?php echo __('Ring Specification') ?>
           </a>
       </h4>

       <div class="form-field diamonds-info">
        <div class="diamond-content-data" id="ring-content-data">
            <div class="diamond-desc">
                <p><?php echo $setting['ringData']['description'] ?></p>
            </div>
            <div class="title-main"><?php echo __('Complete Your Ring'); ?></div>
            <div class="intro-field">

                <?php if (isset($setting['ringData']['metalType'])) { ?>
                    <div class="metaltypemaindiv prdctdrpdwn">
                        <div class="img"> <img src="<?php echo $this->getViewFileUrl('images/Ellipse15.svg'); ?>" alt="metal-type"></div>
                        <span class="title metaltypelabel"><?php echo __('Metal Type'); ?></span>
                        <span class="metaltypedata"><?php echo $setting['ringData']['metalType']; ?></span>
                    </div>
                <?php } ?>
                <?php if (isset($setting['ringData']['sideStoneQuality'][0])) { ?>
                    <div class="sidestonemaindiv prdctdrpdwn">
                        <div class="img"> <img src="<?php echo $this->getViewFileUrl('images/emojione-monotone_diamond-with-a-dot.svg'); ?>" alt="monotone_diamond-type"></div>
                        <span class="title sidestonequalitylabel"><?php echo __('Side Stone Quality'); ?></span>
                        <span class="sidestonequalitydata"><?php echo $setting['ringData']['sideStoneQuality'][0]; ?></span>
                    </div>
                <?php } ?>
                <?php if (isset($setting['ringData']['centerStoneMinCarat']) && isset($setting['ringData']['centerStoneMaxCarat'])) {
                    $mincarat = $maxcarat = 0;
                    ?>
                    <?php if ($setting['ringData']['centerStoneMinCarat'] == $setting['ringData']['centerStoneMaxCarat']) {
                        $mincarat = $setting['ringData']['centerStoneMaxCarat'] - 0.5;
                        $maxcarat = $setting['ringData']['centerStoneMaxCarat'];
                    } else {
                        $mincarat = $setting['ringData']['centerStoneMinCarat'];
                        $maxcarat = $setting['ringData']['centerStoneMaxCarat'];
                    } ?>
                    <div class="sidestonemaindiv prdctdrpdwn">
                        <div class="img"> <img src="<?php echo $this->getViewFileUrl('images/central-stone.svg'); ?>" alt="central-stone"></div>
                        <span class="title sidestonequalitylabel"><?php echo __('Center Stone Size'); ?></span>
                        <span class="sidestonequalitydata"><?php echo $mincarat.' - '.$maxcarat; ?></span>
                    </div>
                <?php } ?>
                <?php if ($setting['ringData']['ringSizeType'] == '' || $setting['ringData']['ringSizeType'] == 'American') { ?>
                    <?php if ($setting['ringData']['ringSize']) { ?>
                       <div class="accordionstep3">
                        <div class="ring-size prdctdrpdwn">
                           <div class="img"> <img src="<?php echo $this->getViewFileUrl('images/rings.svg'); ?>" alt="ring"></div>
                           <span class="title"><?php echo __('Ring Size'); ?> </span>

                           <select class="ringsize-drpdwn" name="ring_size" id="ring_size" onchange="updatesize();">
                            <?php foreach (array_unique($setting['ringData']['ringSize']) as $singleringsize) { ?>
                                <option value="<?php echo $singleringsize; ?>"
                                    <?php if ($singleringsize == $ringSize) {
                                        echo 'selected="selected"';
                                    } ?>>
                                    <?php echo $singleringsize; ?>
                                </option>
                            <?php } ?>
                        </select>
                         <div class="rightactive">
                          <div class="content" id="ringsizecustomoptionactive"></div>
                       </div>
                    </div>
                </div>
                <div class="panel">
                    <div class="filter swatches ring_size" id="ringsizecustomoption">
                      <div class="main">
                         <?php foreach (array_unique($setting['ringData']['ringSize']) as $singlevalue) { ?>
                          <div class="one"><div class="option" data-value="<?= $singlevalue; ?>" data-name="<?= $singlevalue ?>"><?= $singlevalue ?></div></div>
                      <?php } ?>
                  </div>
              </div>
          </div>
      <?php } ?>
  <?php } else { ?>
                    <?php if ($setting['ringData']['ringSize']) { ?>
       <div class="accordionstep3">
        <div class="ring-size prdctdrpdwn">
            <div class="img"> <img src="<?php echo $this->getViewFileUrl('images/rings.svg'); ?>" alt="ring"></div>
            <span class="title"><?php echo __('Ring Size'); ?></span>
            <select class="ringsize-drpdwn" name="ring_size" id="ring_size" onchange="updatesize();">
                        <?php foreach (array_unique($setting['ringData']['ringSize']) as $singleringsize) { ?>
                    <option value="<?php echo $singleringsize; ?>"
                            <?php if ($singleringsize == $ringSize) {
                                echo 'selected="selected"';
                            } ?>>
                            <?php echo $singleringsize; ?>
                    </option>
                <?php } ?>
            </select>
        </div>
    </div>
    <div class="panel">
      <div class="filter swatches ring_size" id="ringsizecustomoption">
        <div class="main">
                        <?php foreach (array_unique($setting['ringData']['ringSize']) as $singlevalue) { ?>
            <div class="one"><div class="option" data-value="<?= $singlevalue; ?>" data-name="<?= $singlevalue ?>"><?= $singlevalue ?></div></div>
        <?php } ?>
    </div>
</div>
</div>
<?php } ?>
<?php } ?>

</div>
<div class="ringprice">
    <span><?php echo _('Setting Price:')?>
    <?php if ($setting['ringData']['showPrice']) { ?>
        <?= $priceHelper->convertToBaseCurrency($setting['ringData']['cost']) ?>
    <?php } else {  ?>
        <?php echo __('Call For Price'); ?>
    <?php } ?>
</span>
</div>
</div>

<div class="diamond-content-data" id="diamond-content-data">
    <?php


    if ($setting['selectedData']->caratmin) {
        $CaratMin = $setting['selectedData']->caratmin;
    } else {
        $CaratMin = 0;
    }

    if ($setting['selectedData']->caratmax > 0) {
        $CaratMax = ($setting['selectedData']->caratmax);
    } else {
        $CaratMax = ($setting['ringData']['centerStoneMaxCarat']);
    }

    if ($diamond['diamondData']['caratWeight'] > $CaratMax || $diamond['diamondData']['caratWeight'] < $CaratMin) { ?>
        <div><p style="color: red;"><?php echo _('This diamond will not properly fit with selected setting.'); ?></p></div>
    <?php } ?>
    <h2><?php echo $diamond['diamondData']['mainHeader'] ?></h2>
    <div class="diamond-sku"><span class="diamond-sku"><?php echo __('SKU#') ?></span><?= $selectedDiamond['diamondData']['diamondId'] ?></div>
    <div class="diamond-desc">
        <p class="subheader"><?php echo $diamond['diamondData']['subHeader'] ?></p>
    </div>
    <?php if ($isDiamondSold = $ringbuilderHelper->isDiamondSold("dl-".$diamond['diamondData']['diamondId'])): ?>
        <div class="validate-msg"><p style="color: red;"><?php echo _('This diamond is no longer available.'); ?></p></div>
    <?php endif; ?>
    <div class="intro-field">
        <ul>
            <li>
                <strong><?php echo __('Color:') ?></strong>
                <p>
                    <?php if ($diamond['diamondData']['color'] != '') {
                        echo $diamond['diamondData']['color'];
                    } else {
                        echo __('NA');
                    } ?>
                </p>
            </li>
            <li>
                <strong><?php echo __('Clarity:') ?></strong>
                <p>
                    <?php if ($diamond['diamondData']['clarity'] != '') {
                        echo $diamond['diamondData']['clarity'];
                    } else {
                        echo __('NA');
                    } ?>
                </p>
            </li>
        </ul>
        <ul>
            <li>
                <strong><?php echo __('Report:') ?></strong>
                <p>
                    <?php if ($diamond['diamondData']['certificate'] != '') {
                        echo $diamond['diamondData']['certificate'];
                    } else {
                        echo __('NA');
                    } ?>
                </p>
            </li>
            <li>
                <strong><?php echo __('Cut:') ?></strong>
                <p>
                    <?php if ($diamond['diamondData']['cut'] != '') {
                        echo $diamond['diamondData']['cut'];
                    } else {
                        echo __('NA');
                    } ?>
                </p>
            </li>
        </ul>
    </div>
    <div class="certificate-image">
        <span class="diamondprice"><?php echo __('Diamond Price:')?>
        <?php if ($diamond['diamondData']['showPrice']) { ?>
            <?= $priceHelper->convertToBaseCurrency($diamond['diamondData']['fltPrice']) ?>
        <?php } else { ?>
            <?php echo __('Call For Price'); ?>
        <?php } ?>
    </span>
</div>
<div class="product-controler">
    <ul>


        <?php if ($block->isMoreInfoEnabled() == 1): ?>
            <li>
                <a href="javascript:;" class="showForm" onclick="CallShowform(event);"
                data-target="req-info-main"><?php echo __('Request More Info'); ?>
            </a>
        </li>
    <?php endif; ?>


    <?php if ($block->isScheduleViewingEnabled() == 1): ?>
        <li>
            <a href="javascript:;" class="showForm" onclick="CallShowform(event);"
            data-target="schedule-view-main"><?php echo __('Schedule Viewing'); ?>
        </a>
    </li>
<?php endif; ?>
</ul>
</div>

<div class="diamond-action">
    <?php if ($diamond['diamondData']['showPrice'] && $setting['ringData']['showPrice']) { ?>
        <span>
            <?= $priceHelper->convertToBaseCurrency($setting['ringData']['cost'] + $diamond['diamondData']['fltPrice']) ?>

        </span>
    <?php } else { ?>
        <span><?php echo __('Call For Price') ; ?></span>
    <?php } ?>

    <form action="<?php echo $block->getAddtocartUrl($setting['ringData']['settingId']); ?>"
      method="post" id="product_addtocart_form">

      <input type="hidden" name="ringId" id="ringId" value="<?= $ringId ?>"/>
      <input type="hidden" name="ringsizesettingonly" id="ringsizesettingonly" value="<?= $ringSize ?>"/>
      <input type="hidden" name="diamondId" id="diamondId" value="<?= $diamondId ?>"/>
      <?php if (isset($diamond['diamondData']['type'])) { ?>
        <input type="hidden" name="diamondtype" id="diamondtype" value="<?php echo $diamond['diamondData']['type']; ?>"/>
    <?php } ?>
    <?php if ($diamond['diamondData']['showPrice'] && $setting['ringData']['showPrice'] && $diamond['diamondData']['dsEcommerce'] && $setting['ringData']['rbEcommerce']) { ?>
        <div class="box-tocart">
            <button type="submit" title="Add To Cart" class="addtocart tocart" onclick="showLoader();" <?php echo $isDiamondSold?"disabled":"" ?>
            id="product_addtocart_button"><?php echo __('Add To Cart') ?> 
            </button>
        </div>
<?php } ?>
</form>
</div>
</div>
</div>

<div class="diamond-forms">
    <?php
    if ($setting['ringData']['metalType']) {
        $metaltype = strtolower(str_replace(' ', '-', $setting['ringData']['metalType'])).'-metaltype-';
    } else {
        $metaltype = '';
    }
    $name = strtolower(str_replace(' ', '-', $setting['ringData']['settingName']));
    $sku = '-sku-'.str_replace(' ', '-', $setting['ringData']['settingId']);
    $ringurl = $metaltype.$name.$sku;
    ?>
    <?php if ($block->isHintEnabled() == 1): ?>
        <div class="form-main no-padding diamond-request-form cls-for-hide"
        id="drop-hint-main">
        <div class="requested-form">
            <h2><?php echo __('Drop A Hint'); ?></h2>
            <p><?php echo __('Because you deserve this.'); ?></p>
        </div>
        <div class="note" style="display: none;"></div>
        <form method="post" enctype="multipart/form-data"
        data-hasrequired="<?php /* @escapeNotVerified */
        echo __('* Required Fields') ?>"
        data-mage-init='{"validation":{}}' class="form-drop-hint"
        id="form-drop-hint">
        <input name="diamondurl" type="hidden"
        value="<?php echo $block->getUrl('ringbuilder/settings/view').'path/'.$ringurl; ?>">
        <input name="settingid" type="hidden"
        value="<?php echo $setting['ringData']['settingId']; ?>">
        <div class="form-field">
            <label>
                <input name="name" id="drophint_name" onfocus="focusFunction(this)"
                onfocusout="focusoutFunction(this)" type="text" class=""
                data-validate="{required:true}" placeholder=" ">
                <span><?php echo __('Your Name'); ?></span>
            </label>
            <label>
                <input name="email" id="drophint_email"
                onfocus="focusFunction(this)"
                onfocusout="focusoutFunction(this)" type="email" class=""
                data-validate="{required:true, 'validate-email':true}"
                placeholder=" ">
                <span><?php echo __('Your E-mail'); ?></span>
            </label>
            <label>
                <input name="recipient_name" id="drophint_rec_name"
                onfocus="focusFunction(this)"
                onfocusout="focusoutFunction(this)" type="text" class=""
                data-validate="{required:true}" placeholder=" ">
                <span><?php echo __('Hint Recipient\'s Name'); ?></span>
            </label>
            <label>
                <input name="recipient_email" id="drophint_rec_email"
                onfocus="focusFunction(this)"
                onfocusout="focusoutFunction(this)" type="email" class=""
                data-validate="{required:true, 'validate-email':true}"
                placeholder=" ">
                <span><?php echo __('Hint Recipient\'s E-mail'); ?></span>
            </label>
            <label>
                <input name="gift_reason" id="gift_reason"
                onfocus="focusFunction(this)"
                onfocusout="focusoutFunction(this)" type="text" class=""
                data-validate="{required:true}" placeholder=" ">
                <span><?php echo __('Reason For This Gift'); ?></span>
            </label>
            <label>
                <textarea name="hint_message" rows="2" cols="20"
                id="drophint_message" class=""
                data-validate="{required:true}"
                placeholder="Add A Personal Message Here ..."></textarea>
            </label>
            <label>
                <div class="has-datepicker--icon">
                    <input name="gift_deadline" id="gift_deadline"
                    class="floatingLabelObserver"
                    autocomplete="false" readonly title="Gift Deadline"
                    value="" type="text" data-validate="{required:true}"
                    placeholder="Gift Deadline">
                </div>
            </label>

            <div class="prefrence-action">
                <div class=" prefrence-action action">

                    <button type="button"
                    onclick="formSubmit(event,'<?php /* @escapeNotVerified */
                    echo $block->getFormAction(); ?>','form-drop-hint')"
                    title="Submit" class="preference-btn">
                    <span><?php echo __('Drop Hint'); ?></span>
                </button>
                <button type="button" data-target="drop-hint-main"
                onclick="Closeform(event);"
                class="cancel preference-btn btn-cencel">
                <span><?php echo __('Cancel'); ?></span></button>
            </div>
        </div>
    </div>
</form>
</div>

<?php endif; ?>

    <?php if ($block->isEmailtoFriendEnabled() == 1): ?>

    <div class="form-main no-padding diamond-request-form cls-for-hide" id="email-friend-main">
        <div class="requested-form"><h2><?php echo __('E-Mail A Friend'); ?></h2></div>
        <div class="note" style="display: none;"></div>

        <form method="post" enctype="multipart/form-data"
        data-hasrequired="<?php /* @escapeNotVerified */
        echo __('* Required Fields') ?>"
        data-mage-init='{"validation":{}}' class="form-email-friend"
        id="form-email-friend">

        <input name="diamondurl" type="hidden"
        value="<?php echo $block->getUrl('ringbuilder/settings/view').'path/'.$ringurl; ?>">
        <input name="settingid" type="hidden"
        value="<?php echo $setting['ringData']['settingId']; ?>">

        <div class="form-field">
            <label>
                <input id="email_frnd_name" name="name"
                onfocus="focusFunction(this)"
                onfocusout="focusoutFunction(this)" placeholder=""
                type="text" class="" data-validate="{required:true}">
                <span for="email_frnd_name"><?php echo __('Your Name'); ?></span>
            </label>
            <label>
                <input name="email" type="email" onfocus="focusFunction(this)"
                onfocusout="focusoutFunction(this)" placeholder=""
                id="email_frnd_email" class=""
                data-validate="{required:true}">
                <span><?php echo __('Your E-mail'); ?></span>
            </label>
            <label>
                <input name="friend_name" type="text" onfocus="focusFunction(this)"
                onfocusout="focusoutFunction(this)" placeholder=""
                id="email_frnd_fname" class=""
                data-validate="{required:true}">
                <span><?php echo __('Your Friend\'s Name'); ?></span>
            </label>

            <label>
                <input name="friend_email" type="email"
                onfocus="focusFunction(this)"
                onfocusout="focusoutFunction(this)" placeholder=""
                id="email_frnd_femail" class=""
                data-validate="{required:true}">
                <span><?php echo __('Your Friend\'s E-mail'); ?></span>
            </label>
            <label>
                <textarea name="message" rows="2"
                placeholder="Add A Personal Message Here ..." cols="20"
                id="email_frnd_message" class=""
                data-validate="{required:true}"></textarea>
            </label>

            <div class="prefrence-action" >
                <div class=" prefrence-action action">

                    <button type="button"
                    onclick="formSubmit(event,'<?php /* @escapeNotVerified */
                    echo $block->getEmailFrndFormAction(); ?>','form-email-friend')"
                    title="Submit" class="preference-btn">
                    <span><?php echo __('Send To Friend'); ?></span>
                </button>
                <button type="button" data-target="email-friend-main"
                onclick="Closeform(event);"
                class="cancel preference-btn btn-cencel">
                <span><?php echo __('Cancel'); ?></span></button>
            </div>
        </div>
    </div>
</form>

</div>

    <?php endif; ?>

    <?php if ($block->isMoreInfoEnabled() == 1): ?>

    <div class="form-main no-padding diamond-request-form cls-for-hide"  id="req-info-main">
        <div class="requested-form">
            <h2><?php echo __('Request More Information'); ?></h2>
            <p><?php echo __('Our specialists will contact you.'); ?></p>
        </div>

        <div class="note" style="display: none;"></div>

        <form method="post" enctype="multipart/form-data"
        data-hasrequired="<?php /* @escapeNotVerified */
        echo __('* Required Fields') ?>"
        data-mage-init='{"validation":{}}' class="form-request-info"
        id="form-request-info">

        <input name="diamondurl" type="hidden"
        value="<?php echo $block->getUrl('ringbuilder/settings/view').'path/'.$ringurl; ?>">
        <input name="settingid" type="hidden"
        value="<?php echo $setting['ringData']['settingId']; ?>">

        <div class="form-field">
            <div class="field placeholder1">
                <input name="name" type="text" onfocus="focusFunction(this)"
                onfocusout="focusoutFunction(this)" id="reqinfo_name"
                placeholder="" class="" data-validate="{required:true}" required>
                <label class="floating-label1"><?php echo __('Your Name'); ?></label>
            </div>
            <div class="field placeholder1">
                <input name="email" type="email" onfocus="focusFunction(this)"
                onfocusout="focusoutFunction(this)" id="reqinfo_email"
                placeholder="" class="" data-validate="{required:true}" required>
                <label class="floating-label1"><?php echo __('Your E-mail Address'); ?></label>
            </div>
            <div class="field placeholder1">
                <input name="phone" type="tel" onfocus="focusFunction(this)"
                onfocusout="focusoutFunction(this)" id="reqinfo_phone"
               data-validate="{required:true}"  class="init_tel" required>
                <label class="floating-label1 ring-phone"><?php echo __('Your Phone Number');?></label>
            </div>
            <div class="field placeholder1">

                <input name="hint_message" type="text" id="reqinfo_message"
                placeholder="" class="" data-validate="{required:true}" required>
                <label class="floating-label1"><?php echo __('Add A Personal Message Here ...'); ?></label>
            </div>
            <div class="prefrence-area field placeholder1">
                <p><?php echo __('Contact Preference:'); ?></p>
                <ul>
                    <li>
                        <input type="radio"
                        data-validate="{'validate-one-required-by-name':true}"
                        class="radio required-entry" name="contact_pref"
                        value="By Email">
                        <label><?php echo __('By Email'); ?></label>
                    </li>
                    <li>
                        <input type="radio"
                        data-validate="{'validate-one-required-by-name':true}"
                        class="radio required-entry" name="contact_pref"
                        value="By Phone">

                        <label><?php echo __('By Phone'); ?></label>
                    </li>
                </ul>
                <div class="prefrence-action">
                    <div class=" prefrence-action action">


                        <button type="button"
                        onclick="formSubmit(event,'<?php /* @escapeNotVerified */
                        echo $block->getReqInfoFormAction(); ?>','form-request-info')"
                        title="Submit" class="preference-btn">

                        <span><?php echo __('Request'); ?></span>
                    </button>
                    <button type="button" data-target="req-info-main"
                    onclick="Closeform(event);"
                    class="cancel preference-btn btn-cencel">
                    <span><?php echo __('Cancel'); ?></span>
                </button>
            </div>
        </div>
    </div>
</div>
</form>
</div>

    <?php endif; ?>

    <?php if ($block->isScheduleViewingEnabled() == 1): ?>

    <div class="form-main no-padding diamond-request-form cls-for-hide"
    id="schedule-view-main">

    <div class="requested-form">
        <h2><?php echo __('Schedule A Viewing'); ?></h2>
        <p><?php echo __('See This Item & More In Our Store'); ?></p>
    </div>

    <div class="note" style="display: none;"></div>

    <form method="post" enctype="multipart/form-data"
    data-hasrequired="<?php /* @escapeNotVerified */
    echo __('* Required Fields') ?>"
    data-mage-init='{"validation":{}}' class="form-schedule-view"
    id="form-schedule-view">

    <input name="diamondurl" type="hidden"
    value="<?php echo $block->getUrl('ringbuilder/settings/view').'path/'.$ringurl; ?>">
    <input name="settingid" type="hidden"
    value="<?php echo $setting['ringData']['settingId']; ?>">

    <div class="form-field">
        <div class="field placeholder1">
            <input name="name" type="text" onfocus="focusFunction(this)"
            onfocusout="focusoutFunction(this)" id="schview_name"
            placeholder="" class="" data-validate="{required:true}" required>
            <label class="floating-label1"><?php echo __('Your Name'); ?></label>
        </div>
        <div class="field placeholder1">
            <input name="email" type="email" onfocus="focusFunction(this)"
            onfocusout="focusoutFunction(this)" id="schview_email"
            class="" data-validate="{required:true}" required>
            <label class="floating-label1"><?php echo __('Your E-mail Address'); ?></label>
        </div>
        <div class="field placeholder1">
            <input name="phone" type="tel" onfocus="focusFunction(this)"
            onfocusout="focusoutFunction(this)" id="schview_phone"
            data-validate="{required:true}" class="init_tel" required>
            <label class="floating-label1 ring-phone"><?php echo __('Your Phone Number'); ?></label>
        </div>
        <div class="field placeholder1">

           <input name="hint_message" type="text"  id="schview_message" class="" data-validate="{required:true}" required>
           <label class="floating-label1"><?php echo __('Add A Personal Message Here ...'); ?></label>
       </div>
       <div class="field placeholder1">
        <select data-validate="{required:true}" name="location"
        placeholder="" id="schview_loc">

        <option value=""><?php echo __('--Location--'); ?></option>

            <?php $retailerInfo = (array)$selectedDiamond['diamondData']['retailerInfo'];

            $addressList = (array)$retailerInfo['addressList']; ?>

            <?php foreach ($addressList as $value) {
                $value = (array)$value; ?>

            <option data-locationid="<?php echo $value['locationID']; ?>" value="<?php echo $value['locationName']; ?>"><?php echo $value['locationName']; ?></option>
        <?php } ?>
    </select>
</div>
<div class="has-datepicker--icon field placeholder1">
    <input name="avail_date" id="avail_date" readonly
    autocomplete="false"
    class="floatingLabelObserver"
    title="When are you available?" value="" type="text"
    data-validate="{required:true}" required>
    <label class="floating-label1"><?php echo __('When are you available?'); ?></label>
</div>
        <?php
                     /*echo "<pre>";
                     print_r((array) $retailerInfo['timingList']);*/
                     $timingListArr = (array)$retailerInfo['timingList'];
        if (empty($timingListArr)) {
            ?>
                        <label class="timing_not_avail" style="display:none;">Slots not available on selected date</label>
                        <?php
        } else {
            $timingDays = $dayStatusArr = [];
            foreach ($timingListArr as $key => $timingList) {

                $timingDays[0] = [
                 "sundayStart" => $timingList->sundayStart,
                 "sundayEnd" => $timingList->sundayEnd
                            ];
                            $timingDays[1] = [
                "mondayStart" => $timingList->mondayStart,
                "mondayEnd" => $timingList->mondayEnd
                            ];
                            $timingDays[2] = [
                            "tuesdayStart" => $timingList->tuesdayStart,
                            "tuesdayEnd" => $timingList->tuesdayEnd
                            ];
                            $timingDays[3] = [
                            "wednesdayStart" => $timingList->wednesdayStart,
                            "wednesdayEnd" => $timingList->wednesdayEnd
                            ];
                            $timingDays[4] = [
                            "thursdayStart" => $timingList->thursdayStart,
                            "thursdayEnd" => $timingList->thursdayEnd
                            ];
                            $timingDays[5] = [
                            "fridayStart" => $timingList->fridayStart,
                            "fridayEnd" => $timingList->fridayEnd
                            ];
                            $timingDays[6] = [
                            "saturdayStart" => $timingList->saturdayStart,
                            "saturdayEnd" => $timingList->saturdayEnd
                            ];
                            if ($timingList->storeClosedSun == "Yes") {
                                $dayStatusArr[0] = 0;
                            }
                            if ($timingList->storeClosedMon == "Yes") {
                                $dayStatusArr[1] = 1;
                            }
                            if ($timingList->storeClosedTue == "Yes") {
                                $dayStatusArr[2] = 2;
                            }
                            if ($timingList->storeClosedWed == "Yes") {
                                $dayStatusArr[3] = 3;
                            }
                            if ($timingList->storeClosedThu == "Yes") {
                                $dayStatusArr[4] = 4;
                            }
                            if ($timingList->storeClosedFri == "Yes") {
                                $dayStatusArr[5] = 5;
                            }
                            if ($timingList->storeClosedSat == "Yes") {
                                $dayStatusArr[6] = 6;
                            }


                            ?>
                         <span class="timing_days" data-location="<?php echo $timingList->locationID;?>" style="display:none;"><?php echo json_encode($timingDays);?></span>
                         <?php

                            foreach ($dayStatusArr as $key => $value) {
                                ?>
                             <span style="display:none;" class="day_status_arr"><?php echo $value;?></span>
                                <?php
                            }
            }
            ?>
                     <label>
                      <select id="appnt_time" class=" test"  placeholder=""  name="appnt_time" style="display:none;"></select>
                  </label>
                  <?php
                    ?>
              <?php } ?>

              <div class="prefrence-action">
                <div class=" prefrence-action action">

                    <button type="button"
                    onclick="formSubmit(event,'<?php echo $block->getScheViewFormAction(); ?>','form-schedule-view')"
                    title="Submit" class="preference-btn">
                    <span><?php echo __('Request'); ?></span>
                </button>
                <button type="button" data-target="schedule-view-main"
                onclick="Closeform(event);"
                class="cancel preference-btn btn-cencel">
                <span><?php echo __('Cancel'); ?></span></button>
            </div>
        </div>
    </div>
</form>
</div>
    <?php endif; ?>
</div>
</div>
</div>
<div class="diamond-specification cls-for-hide" id="ring-specification">

   <div class="specification-info">

      <div class="specification-title">

         <h2><?php echo __('Setting Details'); ?></h2>

         <h4>

            <a href="javascript:;" id="dmnddtl" onclick="CallDiamondDetail();">

               <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
               viewBox="0 0 52 52" width="20px" height="20px" style="enable-background:new 0 0 52 52;display: inline;vertical-align: text-bottom; fill:#828282 !important;" xml:space="preserve">
               <g>
                 <path d="M26,0C11.664,0,0,11.663,0,26s11.664,26,26,26s26-11.663,26-26S40.336,0,26,0z M26,50C12.767,50,2,39.233,2,26
                 S12.767,2,26,2s24,10.767,24,24S39.233,50,26,50z"/>
                 <path d="M35.707,16.293c-0.391-0.391-1.023-0.391-1.414,0L26,24.586l-8.293-8.293c-0.391-0.391-1.023-0.391-1.414,0
                 s-0.391,1.023,0,1.414L24.586,26l-8.293,8.293c-0.391,0.391-0.391,1.023,0,1.414C16.488,35.902,16.744,36,17,36
                 s0.512-0.098,0.707-0.293L26,27.414l8.293,8.293C34.488,35.902,34.744,36,35,36s0.512-0.098,0.707-0.293
                 c0.391-0.391,0.391-1.023,0-1.414L27.414,26l8.293-8.293C36.098,17.316,36.098,16.684,35.707,16.293z"/>
             </g>
         </svg>
     </a>

 </h4>

</div>

<ul>

    <?php if (isset($setting['ringData']['styleNumber'])) { ?>

     <li>

        <div class="diamonds-details-title">

           <p><?php echo __('Setting Number') ?></p>

       </div>

       <div class="diamonds-info">

           <p><?php echo $setting['ringData']['styleNumber'] ?></p>

       </div>

   </li>

<?php } ?>

    <?php if (isset($setting['ringData']['cost'])) { ?>

 <li>

    <div class="diamonds-details-title">

       <p><?php echo __('Price') ?></p>

   </div>

   <div class="diamonds-info">

       <p><?= $priceHelper->convertToBaseCurrency($setting['ringData']['cost']) ?></p>

   </div>

</li>

    <?php } ?>

    <?php if (isset($setting['ringData']['metalType'])) { ?>

 <li>

    <div class="diamonds-details-title">

       <p><?php echo __('Metal Type') ?></p>

   </div>

   <div class="diamonds-info">

       <p><?php echo $setting['ringData']['metalType'] ?></p>

   </div>

</li>

    <?php } ?>

</ul>

</div>
    <?php if (isset($setting['ringData']['sideDiamondDetail1'])) { ?>
   <div class="specification-info">
      <div class="specification-title">
         <h2><?php echo __('Side Diamond Details') ?></h2>
     </div>
     <ul>
           <?php $v = 1; foreach ($setting['ringData']['sideDiamondDetail1'] as $singlesideDiamondDetail1) {  ?>

                <?php if ($singlesideDiamondDetail1->noOfDiamonds != '') { ?>
             <li>
                <div class="diamonds-details-title">
                   <p><?php echo __('Number of Diamonds '.$v) ?></p>
               </div>
               <div class="diamonds-info">
                   <p><?php echo $singlesideDiamondDetail1->noOfDiamonds ?></p>
               </div>
           </li>
       <?php } ?>
                <?php if ($singlesideDiamondDetail1->diamondCut != '') { ?>
         <li>
            <div class="diamonds-details-title">
               <p><?php echo __('Cut '.$v) ?></p>
           </div>
           <div class="diamonds-info">
               <p><?php echo $singlesideDiamondDetail1->diamondCut; ?></p>
           </div>
       </li>
   <?php } ?>
                <?php if ($singlesideDiamondDetail1->minimumCaratWeight != '') { ?>
     <li>
        <div class="diamonds-details-title">
           <p><?php echo __('Minimum Carat Weight(ct.tw.) '.$v) ?></p>
       </div>
       <div class="diamonds-info">
           <p><?php echo $singlesideDiamondDetail1->minimumCaratWeight; ?></p>
       </div>
   </li>
<?php } ?>
                <?php if ($singlesideDiamondDetail1->minimumColor != '') { ?>
 <li>
    <div class="diamonds-details-title">
       <p><?php echo __('Minimum Color '.$v) ?></p>
   </div>
   <div class="diamonds-info">
       <p><?php echo $singlesideDiamondDetail1->minimumColor ?></p>
   </div>
</li>
                <?php } ?>
                <?php if ($singlesideDiamondDetail1->minimumClarity != '') { ?>
 <li>
    <div class="diamonds-details-title">
       <p><?php echo __('Minimum Clarity '.$v) ?></p>
   </div>
   <div class="diamonds-info">
       <p><?php echo $singlesideDiamondDetail1->minimumClarity ?></p>
   </div>
</li>
                <?php } ?>
                <?php if ($singlesideDiamondDetail1->diamondQuality != '') { ?>
 <li>
    <div class="diamonds-details-title">
       <p><?php echo __('Diamond Quality '.$v) ?></p>
   </div>
   <div class="diamonds-info">
       <p><?php echo $singlesideDiamondDetail1->diamondQuality ?></p>
   </div>
</li>
                <?php } ?>

<?php $v++; } ?>
</ul>
</div>
    <?php } ?>
    <?php if ($setting['ringData']['centerStoneFit'] != "") { ?>
   <div class="specification-info">

      <div class="specification-title">

         <h2><?php echo __('Can Be Set With') ?></h2>

     </div>

     <ul>

             <?php  $centerstone = explode(',', $setting['ringData']['centerStoneFit']); ?>
             <?php foreach ($centerstone as $centerstonesingle) { ?>
             <li>

                <div class="diamonds-details-title">

                   <p><?php echo $centerstonesingle; ?></p>

               </div>

               <div class="diamonds-info">

                   <p><?php
                    if ($setting['selectedData']->caratmin) {
                        echo $setting['selectedData']->caratmin.'-';
                    } else {
                        echo '0-';
                    }

                    if ($setting['selectedData']->caratmax) {
                        echo $setting['selectedData']->caratmax;
                    } else {
                        echo $setting['ringData']['centerStoneMaxCarat'];
                    } ?>

            </p>

        </div>

    </li>
<?php } ?>
</ul>
</div>
    <?php } ?>
</div>
</div>
</div>
</div>
</div>

<script>
    <?php

    $dtime = new DateTime("now");
    $dtime->setTimezone(new DateTimeZone('Asia/Hong_Kong'));

    ?>

    var serverDate = '<?= $dtime->format('Y-m-d'); ?>';
    var serverHTime = '<?= $dtime->format('H'); ?>';
    var minSDate = <?= $dtime->format('H') > 19 ? 1 : 0; ?>;
    var minuteSDate = '<?= $dtime->format('i'); ?>';
    function showLoader(){
        document.getElementById("gemfind-loading-mask").style.display ="block";
    }

    require([
        "jquery",
        "fancybox"
        ], function ($) {

         $('div.diamention img').each(function() {

            var src = $(this).attr("data-src");

            var id = $(this).attr("id");

            imageExists1(src, id, function(exists) {

               if(exists){

                  $('#'+id).attr('src',src);

              } else {

                $('#'+id).attr('src','<?php echo $this->getViewFileUrl('Gemfind_Ringbuilder::images/no-image.jpg') ?>');

            }

        });
        });

         function imageExists1(url, id, callback) {

          var img = new Image();

          img.onload = function() { callback(true); };

          img.onerror = function() { callback(false); };

          img.src = url;

      }
      $(document).ready(function () {
        $("#zoom_me").click(function() {
            $('.fotorama__active').click();
        });

    });

  });
</script>
<input type="hidden" name="gemfind_dl_version" value="2.2" />
<?php } else {
    echo __('Something went wrong, please try after some time!');
} ?>
<?php
$poweredvalues = $block->getGemfindEnabledPoweredBy();
if ($poweredvalues) {
    ?>
    <span style="float: right;"><?php echo __('Powered By '); ?><a target="_blank" href="http://www.gemfind.com"><?php echo __('GemFind'); ?></a></span>
<?php } ?>
<script>
 require ([
    'jquery',
    'mage/gallery/gallery'
    ], function ($, gallery) {
       $(function () {
         domObserver = require('Magento_Ui/js/lib/view/utils/dom-observer');
         $(document).ready(function(){
            domObserver.get('.fotorama__nav-wrap.fotorama__nav-wrap--horizontal', function(elem){
            var customCheckbox_Yes_radio = setInterval(function(){
              if($('#magentoGallerywidget .fotorama__nav-wrap.fotorama__nav-wrap--horizontal').length){
               var thumbs = $(elem).detach();
               $('.diamond-image').after(thumbs);
            }
         }, 150);
         });
     });

       $('.magentoGallerywidget').each(function (index, element) {
           gallery({
            "data": <?= $priceHelper->getGalleryImages($setting['ringData']['mainImageURL'], $setting['ringData']['extraImage']) ?>,
            "options": {
              "nav": "thumbs",
              "loop": true,
              "keyboard": true,
              "arrows": false,
              "allowfullscreen": true,
              "showCaption": true,
              "width":232,
              "thumbwidth": 80,
              "thumbheight": 80,
              "height": 232,
              "transition": "slide",
              "navarrows": true,
              "navtype": "thumbs",
              "navdir": "horizontal"
          },
          "fullscreen": {
              "nav": "dots",
              "loop": true,
              "navdir": "horizontal",
              "navarrows": true,
              "navtype": "thumbs",
              "arrows": true,
              "showCaption": true,
              "transition": "slide"
          }
      }, element);
       });
   });
 });
</script>
<script>
 var acc = document.getElementsByClassName("accordionstep3");
 var i;

 for (i = 0; i < acc.length; i++) {
   acc[i].addEventListener("click", function() {
     this.classList.toggle("active");
     var panel = this.nextElementSibling;
     if (panel.style.display === "block") {
       panel.style.display = "none";
   } else {
       panel.style.display = "block";
   }
});
}
</script>
